{{ if hugo.IsProduction }}
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-64BWDRHRGB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    
    gtag('config', 'G-64BWDRHRGB');
</script>

{{ else if eq hugo.Environment "development"}}

<!-- Google won't index this page or follow links -->
<meta name="robots" content="noindex. nofollow">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PB98MPZ31B"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    
    gtag('config', 'G-PB98MPZ31B');
</script>

{{ end }}


<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Corrects IE Compatibility Mode -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>{{ block "title" . }}
    {{- if .Params.seo_title -}}{{ .Params.seo_title }}{{- else -}}{{ .Title }}{{ end }} &#x7c; {{ .Site.Title }}
{{- end -}}</title>

{{/*  content translations  */}}

{{- if .IsTranslated -}}
	{{- range .Translations -}}
	<link rel="alternate" hreflang="{{ .Language.Lang }}" href="{{ .RelPermalink }}" title="{{ .Language.LanguageName }}">
	{{- end -}}
{{- end -}}

{{- partial "seo" . -}}

{{- if .Params.mapLib -}}
<!-- nyc-lib css (for maps in the core framework)-->
<link href="https://maps.nyc.gov/nyc-lib/v1.2.79/css/nyc-basic-lib.css" rel="stylesheet">
{{- end -}}

<!-- jQuery (full, compressed version) -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

<!-- favicon -->
<!-- https://www.iconfinder.com/icons/7618350/heatmap_business_analytics_statistics_icon -->
<!-- https://lucianojung.de/ -->
<link rel="icon" href="{{ site.BaseURL }}7618350_heatmap_business_analytics_statistics_icon-gpr.ico">

<!-- Font Awesome -->
<link rel="stylesheet" href="{{ site.BaseURL }}fontawesome/css/all.min.css">

<!-- main CSS -->
{{- $sass := resources.Get "scss/theme.scss" -}}
{{- $style := $sass | resources.ToCSS -}}
<link rel="stylesheet" href="{{ $style.RelPermalink }}" />

<!-- Vega. To call, have vega: true in a page's frontmatter -->
{{- if .Params.vega -}}
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
{{- end -}}

<!-- sanitizing html strings -->
<script src="https://cdn.jsdelivr.net/npm/dompurify@2.3.10/dist/purify.min.js"
    integrity="sha256-keaR/uWEpEmmUnoJ6BemH9gp9Ng8u/YplhVwdmmquNY="
    crossorigin="anonymous"></script>

<!--Other data libraries. To call, have datatables: true in a page's frontmatter-->
{{- if .Params.datatables -}}
    <!--D3-->
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <!--DataTables CSS-->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.1.0/css/buttons.dataTables.min.css">

    <!--DataTables JS-->
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.1.0/js/dataTables.buttons.min.js"></script>
    {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"
        integrity="sha512-oaT4uVdyleJGVHZqklOx2Bb8WhOTBW3iCXRtgk3+YutYmFx0jSs97UR3/+r1vh1Isyb3GOGjFonLbS6LFiiEVA=="
        crossorigin="anonymous"></script>  */}}
    {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"
        integrity="sha512-guWTt6syHB4T9gdPdw8W1iQUGqqricRt5VRjnjgMPpOhUhwOsxmXpk2SImqfcPgsiroK00z/loICebflVeJvqg=="
        crossorigin="anonymous"></script>  */}}
    {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"
        integrity="sha512-vv3EN6dNaQeEWDcxrKPFYSFba/kgm//IUnvLPMPadaUf5+ylZyx4cKxuc4HdBf0PPAlM7560DV63ZcolRJFPqA=="
        crossorigin="anonymous"></script>  */}}
    <script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.print.min.js"></script>
    <script src="https://cdn.datatables.net/rowgroup/1.1.4/js/dataTables.rowGroup.min.js"></script>
{{- end -}}

<!-- Arquero -->
{{- if .Params.arquero -}}
    <script src="https://cdn.jsdelivr.net/npm/arquero@5.0.0/dist/arquero.min.js"
        integrity="sha256-/zlNWswLuC4RosePYPfLgXO2UB9ZnEFd5yERf44WeMU="
        crossorigin="anonymous"></script>
{{- end -}}

<!-- Leaflet -->
{{- if .Params.leaflet -}}

    <!-- leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />

    <!-- leaflet source -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

    <!-- easybutton -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2.4.0/src/easy-button.css"
        integrity="sha256-ceeoylCL0ld4NwOaXf4vG0Z8pEknXXuzJ5ZV0Ir6ft4="
        crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2.4.0/src/easy-button.js"
        integrity="sha256-46nnM+JNAhwyXw6N+fnaZzFa9R20dVa8v0mdBgE9Nn8="
        crossorigin="anonymous"></script>

    <!-- Leaflet.colorIcon -->
    <!-- https://github.com/shevekk/Leaflet.ColorIcon -->
    {{ $colorIcon := resources.Get "js/L.colorIcon.js" }} <!-- need to use Hugo Pipes to get file from assets dir -->
    <script src="{{ $colorIcon.RelPermalink }}"></script>


{{- end -}}

<!--Other data libraries. To call, have data: true in a page's frontmatter-->
{{- if .Params.datalibraries -}}
  <!--D3-->
  <script src="https://d3js.org/d3.v5.min.js"></script>

  <!--DataTables CSS-->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.1.0/css/buttons.dataTables.min.css">

  <!--DataTables JS-->
  <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.1.0/js/dataTables.buttons.min.js"></script>
  {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"
    integrity="sha512-oaT4uVdyleJGVHZqklOx2Bb8WhOTBW3iCXRtgk3+YutYmFx0jSs97UR3/+r1vh1Isyb3GOGjFonLbS6LFiiEVA=="
    crossorigin="anonymous"></script>  */}}
  {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"
    integrity="sha512-guWTt6syHB4T9gdPdw8W1iQUGqqricRt5VRjnjgMPpOhUhwOsxmXpk2SImqfcPgsiroK00z/loICebflVeJvqg=="
    crossorigin="anonymous"></script>  */}}
  {{/*  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"
    integrity="sha512-vv3EN6dNaQeEWDcxrKPFYSFba/kgm//IUnvLPMPadaUf5+ylZyx4cKxuc4HdBf0PPAlM7560DV63ZcolRJFPqA=="
    crossorigin="anonymous"></script>  */}}
  <script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.html5.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.1.0/js/buttons.print.min.js"></script>
  <script src="https://cdn.datatables.net/rowgroup/1.1.4/js/dataTables.rowGroup.min.js"></script>

  <!--Arquero-->
  <script src="https://cdn.jsdelivr.net/npm/arquero@5.0.0/dist/arquero.min.js"
    integrity="sha256-/zlNWswLuC4RosePYPfLgXO2UB9ZnEFd5yERf44WeMU="
    crossorigin="anonymous"></script>

{{- end -}}

<script>
    let sitepath = "{{ $.Site.Params.sitepath }}";
    let baseURL = "{{ $.Site.BaseURL }}";
    let data_repo = "{{ $.Site.Params.data_repo }}";
    let data_branch = "{{ $.Site.Params.data_branch }}";
</script>