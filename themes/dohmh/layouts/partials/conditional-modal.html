<style>
    .modal-backdrop.show {
        opacity: 0.70;
        background-color: #424242
    }
</style>

{{- if eq hugo.Environment "production" -}} 

<div class="modal" tabindex="-1" role="dialog" id="prototypeModal">
    <div class='modal-dialog modal-lg modal-dialog-centered' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h5 class='modal-title'>Welcome to the new Environment & Health Data Portal site. </h5>
            </div>
            <div class='modal-body'>
                <p>The site may look different, but a lot of the content is the same on the old site. We hope we've made it easier to find and understand information on the site.
                </p>
                <p><strong>Please sign up for our email list</strong>. We will email you every few months with updates,
                    or opportunities to participate in user research. 
                    <a href='https://docs.google.com/forms/d/e/1FAIpQLSfUg3JE5ODNc6aqBPJwM8mZ80TYtK6ISw-OM7PBwKuoN3M--g/viewform'>Click here to sign up</a>.
                </p>
                <br />
                <!--
                <p>Prefer to use the old site? <a id="want_old_site" class="close-dialog" data-dismiss="modal" onclick="setCookie()">Click here.</a></p>-->
            </div>
            <hr>
            <button type="button" class="btn btn-outline-primary close-dialog" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

<script>

    // set cookie on click

    const setCookie = () => {
        document.cookie = "want_old_site=true; path=/IndicatorPublic/";
        $('#prototypeModal').modal('hide');
    }

    // get original page URL before redirect

    let original_url = document.cookie
        .split(';')
        .find((row) => row.startsWith('original_url='))
        ?.replace("original_url=", "");

    original_url = original_url ? original_url : "/IndicatorPublic/";

    {{/*  console.log("original_url", original_url);  */}}
    
    // redirect to originally clicked URL

    document.querySelector("#want_old_site").href = original_url;

</script>


{{/*  evaluate script after modal definition  */}}

<script src="{{ site.BaseURL }}js/conditional-modal.js"></script>

{{- end -}} 


{{- if eq hugo.Environment "development" -}} 

<div class="modal" tabindex="-1" role="dialog" id="prototypeModal">
    <div class='modal-dialog modal-lg modal-dialog-centered' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h5 class='modal-title'>Welcome to the Prototype EH Data website. </h5>
            </div>
            <div class='modal-body'>
                <p>Welcome to our <em>development</em> site. Not all of the data or information on this site is final. <a href="https://a816-dohbesp.nyc.gov/IndicatorPublic/beta/">Please visit our production site here</a>.
                </p>
                <p><strong>Please sign up for our email list</strong>. We will email you every few months with updates,
                    or opportunities to participate in user research. 
                    <a href='https://docs.google.com/forms/d/e/1FAIpQLSfUg3JE5ODNc6aqBPJwM8mZ80TYtK6ISw-OM7PBwKuoN3M--g/viewform'>Click here to sign up</a>.
                </p>
            </div>
            <hr>
            <button type="button" class="btn btn-outline-primary close-dialog" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

{{/*  evaluate script after modal definition  */}}

<script src="{{ site.BaseURL }}js/conditional-modal.js"></script>

{{- end -}} 


{{- if eq hugo.Environment "data_staging" -}} 

{{/*  don't show the modal for data staging  */}}

<div class="modal" tabindex="-1" role="dialog" id="prototypeModal">
    <div class='modal-dialog modal-lg modal-dialog-centered' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h5 class='modal-title'>Welcome to the new Environment & Health Data Portal site. </h5>
            </div>
            <div class='modal-body'>
                <p>The site may look different, but a lot of the content is the same on the old site. We hope we've made it easier to find and understand information on the site.
                </p>
                <p><strong>Please sign up for our email list</strong>. We will email you every few months with updates,
                    or opportunities to participate in user research. 
                    <a href='https://docs.google.com/forms/d/e/1FAIpQLSfUg3JE5ODNc6aqBPJwM8mZ80TYtK6ISw-OM7PBwKuoN3M--g/viewform'>Click here to sign up</a>.
                </p>
                <br />
                <p>Prefer to use the old site? <a id="want_old_site" class="close-dialog" data-dismiss="modal" onclick="setCookie()">Click here.</a></p>
            </div>
            <hr>
            <button type="button" class="btn btn-outline-primary close-dialog" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

<script>

    // set cookie on click

    const setCookie = () => {
        document.cookie = "want_old_site=true; path=/IndicatorPublic/";
        $('#prototypeModal').modal('hide');
    }

    // get original page URL before redirect

    let original_url = document.cookie
        .split(';')
        .find((row) => row.startsWith('original_url='))
        ?.replace("original_url=", "");

    original_url = original_url ? original_url : "/IndicatorPublic/";
    
    {{/*  console.log("original_url", original_url);  */}}
    
    // redirect to originally clicked URL

    document.querySelector("#want_old_site").href = original_url;
    
</script>


{{/*  evaluate script after modal definition  */}}

<script src="{{ site.BaseURL }}js/conditional-modal.js"></script>

{{- end -}} 
